<div class="page-container p-4">

  <!-- PAGE HEADER -->
  <div class="page-header mb-6">
    <div>
      <h2 class="text-xl font-semibold">New Journal Entry</h2>
      <div class="text-sm text-[var(--text-secondary)]">
        Accounts / Journals / New
      </div>
    </div>

    <div class="actions">
      <button mat-stroked-button (click)="cancel()">Cancel</button>
      <button
        mat-flat-button
        color="primary"
        [disabled]="form.invalid || posting"
        (click)="submit()">
        Post Journal
      </button>
    </div>
  </div>

  <!-- FORM -->
  <div class="bg-[var(--surface)] rounded p-4">

    <form [formGroup]="form" class="space-y-4">

      <!-- HEADER FIELDS -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <mat-form-field appearance="fill">
          <mat-label>Reference</mat-label>
          <input matInput formControlName="reference" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Description</mat-label>
          <input matInput formControlName="description" />
        </mat-form-field>
      </div>

      <!-- LINES -->
      <div class="table-wrapper">
        <table class="journal-lines">
          <thead>
            <tr>
              <th>Account</th>
              <th>Direction</th>
              <th>Amount</th>
              <th></th>
            </tr>
          </thead>

          <tbody formArrayName="lines">
            <tr *ngFor="let g of lines.controls; let i = index"
                [formGroupName]="i">

              <td>
                <mat-form-field appearance="fill">
                  <mat-select formControlName="accountId">
                    <mat-option *ngFor="let a of (accounts$ | async)"
                                [value]="a.id">
                      {{ a.code }} â€” {{ a.name }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </td>

              <td>
                <mat-form-field appearance="fill">
                  <mat-select formControlName="direction">
                    <mat-option value="DEBIT">Debit</mat-option>
                    <mat-option value="CREDIT">Credit</mat-option>
                  </mat-select>
                </mat-form-field>
              </td>

              <td>
                <mat-form-field appearance="fill">
                  <input matInput type="number" formControlName="amount" />
                </mat-form-field>
              </td>

              <td class="actions-cell">
                <button
                  mat-icon-button
                  type="button"
                  (click)="removeLine(i)"
                  matTooltip="Remove line">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>

            </tr>
          </tbody>
        </table>
      </div>

      <!-- ADD LINE -->
      <button mat-stroked-button type="button" (click)="addLine()">
        <mat-icon>add</mat-icon>
        Add Line
      </button>

    </form>

  </div>
</div>