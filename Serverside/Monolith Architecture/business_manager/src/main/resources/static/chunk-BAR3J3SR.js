import{a as pe}from"./chunk-L7YUQAZ5.js";import{a as de}from"./chunk-VMKMSPCZ.js";import{a as le,b as ce}from"./chunk-3WA4OH2X.js";import{a as me,b as se}from"./chunk-KPX6MBY5.js";import{a as W,b as X,c as Y,d as Z,e as ee,f as te,g as oe,h as ie,i as ne,j as ae,k as re}from"./chunk-NDRSAYSM.js";import{a as j,b as U,c as L,h as K}from"./chunk-G6DPSII6.js";import{a as A,b as H}from"./chunk-GQKP7E5B.js";import{b as R,c as F}from"./chunk-F3TBVMOI.js";import{c as J,d as Q}from"./chunk-ZFWGKVXC.js";import{b as q,h as G}from"./chunk-3ZV2DC5Q.js";import{d as O,h as E,k as T,o as V,x as z}from"./chunk-Z2GGFO6C.js";import{f as B,g as N,h as $}from"./chunk-TENNXE3V.js";import{Bb as y,E as P,H as b,Ib as n,Jb as a,Kb as S,Lb as C,Mb as x,Ob as h,Qb as s,Rb as m,ac as l,bb as c,bc as k,bd as I,cc as u,gb as w,m as D,ma as d,na as p,nb as v,q as M,sb as f,zb as g}from"./chunk-3DYKM6ZU.js";var ge=o=>({listImages:t=>o.getImages(t).pipe(M(e=>(e??[]).map(i=>({fileName:i.split("/").pop(),image:!0})))),listImageAudits:t=>D([]),getImageBlob:(t,e)=>o.getImageBlob(t,e),uploadImages:()=>{throw new Error("Upload not allowed from selector")},softDeleteImage:()=>{throw new Error("Delete not allowed from selector")},restoreImage:()=>{throw new Error("Restore not allowed from selector")},hardDeleteImage:()=>{throw new Error("Hard delete not allowed from selector")}});function _e(o,t){o&1&&S(0,"th",31)}function fe(o,t){if(o&1){let e=h();n(0,"td",32)(1,"mat-checkbox",33),s("click",function(r){return d(e),p(r.stopPropagation())})("change",function(){let r=d(e).$implicit,_=m();return p(_.toggle(r))}),a()()}if(o&2){let e=t.$implicit,i=m();c(),g("checked",i.selected.has(e.id))}}function he(o,t){if(o&1){let e=h();n(0,"th",34),s("click",function(){d(e);let r=m();return p(r.sortBy("name"))}),n(1,"span",35),l(2," Name "),n(3,"mat-icon",36),l(4),a()()()}if(o&2){let e=m();c(4),u(" ",e.sortField==="name"?e.sortDir==="asc"?"arrow_upward":"arrow_downward":"unfold_more"," ")}}function Ce(o,t){if(o&1&&(n(0,"td",37)(1,"div",38)(2,"div",39),l(3),a(),n(4,"div",40),l(5),a()()()),o&2){let e=t.$implicit;c(3),k(e.name),c(2),u(" ",e.categoryName||"\u2014"," ")}}function xe(o,t){if(o&1){let e=h();n(0,"th",41),s("click",function(){d(e);let r=m();return p(r.sortBy("categoryName"))}),n(1,"span",35),l(2," Category "),n(3,"mat-icon",36),l(4),a()()()}if(o&2){let e=m();c(4),u(" ",e.sortField==="categoryName"?e.sortDir==="asc"?"arrow_upward":"arrow_downward":"unfold_more"," ")}}function we(o,t){if(o&1&&(n(0,"td",42),l(1),a()),o&2){let e=t.$implicit;c(),u(" ",e.categoryName||"\u2014"," ")}}function Se(o,t){if(o&1){let e=h();n(0,"th",43),s("click",function(){d(e);let r=m();return p(r.sortBy("sku"))}),n(1,"span",35),l(2," SKU "),n(3,"mat-icon",36),l(4),a()()()}if(o&2){let e=m();c(4),u(" ",e.sortField==="sku"?e.sortDir==="asc"?"arrow_upward":"arrow_downward":"unfold_more"," ")}}function De(o,t){if(o&1&&(n(0,"td",44),l(1),a()),o&2){let e=t.$implicit;c(),u(" ",e.sku||"\u2014"," ")}}function Me(o,t){o&1&&S(0,"th",45)}function Pe(o,t){if(o&1){let e=h();n(0,"td",46)(1,"button",47),s("click",function(r){let _=d(e).$implicit;return m().openImages(_),p(r.stopPropagation())}),n(2,"mat-icon"),l(3,"image"),a()()()}}function be(o,t){o&1&&S(0,"tr",48)}function ve(o,t){if(o&1){let e=h();n(0,"tr",49),s("click",function(){let r=d(e).$implicit,_=m();return p(_.toggle(r))}),a()}if(o&2){let e=t.$implicit,i=m();y("row-selected",i.isSelected(e))}}var ue=class o{constructor(t,e,i,r){this.productService=t;this.dialogRef=e;this.dialog=i;this.data=r}searchCtrl=new T("");products=[];selected=new Set;total=0;page=0;size=20;pageSizeOptions=[5,10,20,50];sortField=null;sortDir="asc";displayedColumns=["select","name","category","sku","images"];ngOnInit(){this.load(),this.searchCtrl.valueChanges.pipe(P(300),b()).subscribe(()=>{this.page=0,this.load()})}load(){let t={page:this.page,size:this.size,includeDeleted:!1},e=this.searchCtrl.value?.trim();e&&(t.keyword=e),this.sortField&&(t.sortBy=this.sortField,t.direction=this.sortDir),this.productService.getAdvanced(t).subscribe(i=>{this.products=i.content??[],this.total=i.totalElements??0})}sortBy(t){this.sortField===t?this.sortDir=this.sortDir==="asc"?"desc":"asc":(this.sortField=t,this.sortDir="asc"),this.load()}pageChanged(t){this.page=t.pageIndex,this.size=t.pageSize,this.load()}toggle(t){this.selected.has(t.id)?this.selected.delete(t.id):this.selected.add(t.id)}isSelected(t){return this.selected.has(t.id)}openImages(t){this.dialog.open(de,{width:"900px",data:{entityId:t.id,adapter:ge(this.productService),readonly:!0}})}confirm(){let t=this.products.filter(e=>this.selected.has(e.id));this.dialogRef.close(t)}cancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||o)(w(pe),w(j),w(L),w(U))};static \u0275cmp=v({type:o,selectors:[["ng-component"]],decls:37,vars:10,consts:[[1,"dialog-container"],[1,"dialog-header"],[1,"title"],[1,"badge"],[1,"search-wrapper"],["appearance","fill",1,"w-full"],["matInput","","placeholder","Name, SKU\u2026",3,"formControl"],[1,"table-wrapper"],[1,"table-scroll"],["mat-table","",1,"product-table",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","","class","col-select",4,"matHeaderCellDef"],["mat-cell","","class","col-select",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","class","sortable col-name",3,"click",4,"matHeaderCellDef"],["mat-cell","","class","col-name",4,"matCellDef"],["matColumnDef","category"],["mat-header-cell","","class","sortable col-category",3,"click",4,"matHeaderCellDef"],["mat-cell","","class","col-category",4,"matCellDef"],["matColumnDef","sku"],["mat-header-cell","","class","sortable col-sku",3,"click",4,"matHeaderCellDef"],["mat-cell","","class","col-sku",4,"matCellDef"],["matColumnDef","images"],["mat-header-cell","","class","col-images",4,"matHeaderCellDef"],["mat-cell","","class","col-images",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"row-selected","click",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"page","length","pageIndex","pageSize","pageSizeOptions"],[1,"dialog-actions"],["mat-stroked-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],["mat-header-cell","",1,"col-select"],["mat-cell","",1,"col-select"],[3,"click","change","checked"],["mat-header-cell","",1,"sortable","col-name",3,"click"],[1,"sortable-content"],[1,"sort-icon"],["mat-cell","",1,"col-name"],[1,"name-block"],[1,"name-text"],[1,"mobile-category"],["mat-header-cell","",1,"sortable","col-category",3,"click"],["mat-cell","",1,"col-category"],["mat-header-cell","",1,"sortable","col-sku",3,"click"],["mat-cell","",1,"col-sku"],["mat-header-cell","",1,"col-images"],["mat-cell","",1,"col-images"],["mat-icon-button","","matTooltip","View product images","matTooltipPosition","above",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),l(3,"Select Products"),a(),n(4,"div",3),l(5),a()(),n(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),l(9,"Search products"),a(),S(10,"input",6),a()(),n(11,"div",7)(12,"div",8)(13,"table",9),C(14,10),f(15,_e,1,0,"th",11)(16,fe,2,1,"td",12),x(),C(17,13),f(18,he,5,1,"th",14)(19,Ce,6,2,"td",15),x(),C(20,16),f(21,xe,5,1,"th",17)(22,we,2,1,"td",18),x(),C(23,19),f(24,Se,5,1,"th",20)(25,De,2,1,"td",21),x(),C(26,22),f(27,Me,1,0,"th",23)(28,Pe,4,0,"td",24),x(),f(29,be,1,0,"tr",25)(30,ve,1,2,"tr",26),a()(),n(31,"mat-paginator",27),s("page",function(_){return i.pageChanged(_)}),a()(),n(32,"div",28)(33,"button",29),s("click",function(){return i.cancel()}),l(34,"Cancel"),a(),n(35,"button",30),s("click",function(){return i.confirm()}),l(36," Add Selected "),a()()()),e&2&&(c(5),u(" ",i.selected.size," selected "),c(5),g("formControl",i.searchCtrl),c(3),g("dataSource",i.products),c(16),g("matHeaderRowDef",i.displayedColumns),c(),g("matRowDefColumns",i.displayedColumns),c(),g("length",i.total)("pageIndex",i.page)("pageSize",i.size)("pageSizeOptions",i.pageSizeOptions),c(4),g("disabled",i.selected.size===0))},dependencies:[I,z,O,E,V,re,W,Y,oe,Z,X,ie,ee,te,ne,ae,se,me,Q,J,G,q,$,N,B,F,R,H,A,ce,le,K],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:85vh;padding:16px;gap:12px;box-sizing:border-box}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.title[_ngcontent-%COMP%]{font-size:1.05rem;font-weight:600}.badge[_ngcontent-%COMP%]{background:#007aff1a;color:#007aff;padding:4px 10px;border-radius:999px;font-size:.75rem;font-weight:600}.table-wrapper[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-height:0;border:1px solid var(--border);border-radius:6px;overflow:hidden}.table-scroll[_ngcontent-%COMP%]{flex:1;min-height:0;overflow:auto}.product-table[_ngcontent-%COMP%]{width:100%}.col-select[_ngcontent-%COMP%]{width:48px;max-width:48px}.col-images[_ngcontent-%COMP%]{width:60px;max-width:60px;text-align:center}.col-sku[_ngcontent-%COMP%]{width:140px;max-width:160px}.col-category[_ngcontent-%COMP%]{width:180px;max-width:220px}.col-name[_ngcontent-%COMP%]{width:auto}.mat-mdc-cell[_ngcontent-%COMP%], .mat-mdc-header-cell[_ngcontent-%COMP%]{padding:8px 12px}.col-name[_ngcontent-%COMP%], .col-category[_ngcontent-%COMP%], .col-sku[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.col-images[_ngcontent-%COMP%], .col-select[_ngcontent-%COMP%]{overflow:visible}.name-block[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mobile-category[_ngcontent-%COMP%]{display:none;font-size:.75rem;color:var(--text-secondary);margin-top:2px}.mat-mdc-header-row[_ngcontent-%COMP%]{position:sticky;top:0;background:var(--surface);z-index:2}.row-selected[_ngcontent-%COMP%]{background-color:#007aff14!important;border-left:4px solid #007aff}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px}@media (max-width: 650px){.dialog-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:6px}.col-category[_ngcontent-%COMP%]{display:none}.mobile-category[_ngcontent-%COMP%]{display:block}.col-sku[_ngcontent-%COMP%]{width:110px}.mat-mdc-row[_ngcontent-%COMP%]{height:50px}}"]})};export{ue as a};
