import{a as Qe,b as le,c as se,d as pe,e as de}from"./chunk-3YA57QE4.js";import{a as me,b as y}from"./chunk-7DWOBMMK.js";import"./chunk-AAX6GH5U.js";import"./chunk-L3RCXL5W.js";import{a as Ke,b as ze,c as Je}from"./chunk-DHVK64AT.js";import"./chunk-I43GAN7W.js";import{c as qe,d as $e}from"./chunk-PUDW2OXT.js";import{a as Re,b as Fe,c as Pe,d as Ve,e as Ae,f as Le,g as Ue,h as je,i as Ge,j as We,k as He}from"./chunk-IFBDMVRJ.js";import"./chunk-VGEQVDR7.js";import{a as Te,b as Be}from"./chunk-JNUXAAQA.js";import{a as Ne,c as Oe}from"./chunk-727AWRP5.js";import{a as ae}from"./chunk-HHYKBKON.js";import"./chunk-NUV7N7IM.js";import"./chunk-PJQ2W5C7.js";import"./chunk-2CD73GIG.js";import{b as ie,c as re}from"./chunk-NP55MDY3.js";import"./chunk-NKX2CJ22.js";import{c as W,d as H}from"./chunk-IMZ4R6CL.js";import{b as oe,h as j,i as G}from"./chunk-EWJIHEWL.js";import"./chunk-SGYCFQGT.js";import{d as O,f as ee,h as R,i as F,m as P,n as V,p as A,q as we,r as ke,s as L,v as te,x as U}from"./chunk-J63CKRDU.js";import"./chunk-CN565FBG.js";import{f as ne,g as I,h as D}from"./chunk-A6LP6NU3.js";import"./chunk-7XXZ3FER.js";import{b as Y,d as Z,e as w,h as k}from"./chunk-PBEYJMJD.js";import"./chunk-LMLMO6HS.js";import"./chunk-5DTMLZHP.js";import{$c as C,Ib as a,Jb as i,Kb as c,Lb as q,Mb as $,Ob as K,Qb as b,Rb as S,Rc as Ee,Sc as X,ac as o,bb as s,bc as Q,cc as v,dc as Me,fc as M,gb as d,gc as x,hc as E,kc as xe,lc as z,ma as u,na as f,nb as _,q as J,qb as Se,sb as g,zb as p}from"./chunk-IL4QWM46.js";import{a as B,b as N,g as Ie,h as De}from"./chunk-FJYW2LMB.js";var Xe={title:"Bulk Import Departments",confirmLabel:"Import Now",csvFileName:"departments-bulk-template.csv",excelFileName:"departments-bulk-template.xlsx",supportsArchiveImport:!1,headers:["name","description","rollcallStartTime","gracePeriodMinutes","branchCodes","headUsernames","memberUsernames"],fields:[{name:"name",required:!0},{name:"description"},{name:"rollcallStartTime",defaultValue:"09:00"},{name:"gracePeriodMinutes",defaultValue:15},{name:"branchCodes",required:!0,defaultValue:"MAIN"},{name:"headUsernames"},{name:"memberUsernames"}],previewColumns:[{key:"name",label:"Name"},{key:"branches",label:"Branches"},{key:"heads",label:"Heads"},{key:"members",label:"Members"}],excelSheetName:"Departments",excelColumns:[{header:"name",key:"name",width:26},{header:"description",key:"description",width:36},{header:"rollcallStartTime",key:"rollcallStartTime",width:20,format:"text"},{header:"gracePeriodMinutes",key:"gracePeriodMinutes",width:22},{header:"branchCodes",key:"branchCodes",width:22,format:"text"},{header:"headUsernames",key:"headUsernames",width:28,format:"text"},{header:"memberUsernames",key:"memberUsernames",width:32,format:"text"}],exampleRow:{name:"Management",description:"Cash handling and budgeting",rollcallStartTime:"09:00",gracePeriodMinutes:15,branchCodes:"MAIN",headUsernames:"Samuel Kimani;Mary Wanjiku",memberUsernames:"Catherine Wairimu"},emptyRowCount:200,defaultOptions:{dryRun:!0},mapRowToItem(r){return{name:r.name,description:r.description,rollcallStartTime:r.rollcallStartTime,gracePeriodMinutes:r.gracePeriodMinutes!=null?Number(r.gracePeriodMinutes):null,branchCodes:r.branchCodes?r.branchCodes.split(",").map(t=>t.trim()):[],headUsernames:r.headUsernames?r.headUsernames.split(",").map(t=>t.trim()):[],memberUsernames:r.memberUsernames?r.memberUsernames.split(",").map(t=>t.trim()):[]}},mapPreviewRow(r){return N(B({},r),{branches:Array.isArray(r.branches)?r.branches.map(t=>t.branchCode||t.name).join(", "):"",heads:Array.isArray(r.heads)?r.heads.map(t=>t.username).join(", "):"",members:Array.isArray(r.members)?r.members.map(t=>t.username).join(", "):""})},submit(r){return null}};function nt(r,t){if(r&1&&(a(0,"div",22),o(1),i()),r&2){let n=S().$implicit;s(),v(" ",n.value._error," ")}}function at(r,t){if(r&1){let n=K();a(0,"div",10)(1,"div",11)(2,"span"),o(3),i(),a(4,"button",12),b("click",function(){let l=u(n).index,m=S();return f(m.removeRow(l))}),a(5,"mat-icon"),o(6,"delete"),i()()(),a(7,"div",13)(8,"mat-form-field"),c(9,"input",14),i(),a(10,"mat-form-field"),c(11,"input",15),i(),a(12,"mat-form-field"),c(13,"input",16),i()(),a(14,"mat-form-field"),c(15,"input",17),i(),a(16,"div",13)(17,"mat-form-field"),c(18,"input",18),i(),a(19,"mat-form-field"),c(20,"input",19),i(),a(21,"mat-form-field"),c(22,"input",20),i()(),g(23,nt,2,1,"div",21),i()}if(r&2){let n=t.$implicit,e=t.index;p("formGroupName",e),s(3),v("Department ",e+1,""),s(20),p("ngIf",n.value._error)}}var ce=class r extends Ke{constructor(n,e,l){super();this.departmentService=n;this.submitEngine=e;this.dialogRef=l}config=Xe;ngOnInit(){this.initForm({updateExisting:!1})}submit(){if(this.form.invalid)return;let n={items:this.rows.controls.map(e=>this.config.mapRowToItem(e.value)),options:{dryRun:this.form.value.dryRun,updateExisting:this.form.value.updateExisting,skipDuplicates:!0}};this.submitEngine.execute({submitFn:e=>this.departmentService.bulkImport(e),payload:n,rows:this.rows.controls,dryRun:this.form.value.dryRun,title:this.config.title,confirmLabel:this.config.confirmLabel,columns:this.config.previewColumns,onErrorsApplied:e=>{this.cacheErrors(e),this.config.mapPreviewRow&&Array.isArray(e.data)&&(e.data=e.data.map(l=>this.config.mapPreviewRow(l)))},onFinalSuccess:()=>this.dialogRef.close(!0),onConfirmRetry:()=>{this.form.patchValue({dryRun:!1}),this.submit()}})}importExcel(n){return De(this,null,function*(){if(!n)return;let e=yield this.confirmMerge();e&&Ie(r.prototype,this,"importExcelFile").call(this,n,void 0,e)})}importCsv(n){return De(this,null,function*(){if(!n)return;let e=yield this.confirmMerge();e&&Ie(r.prototype,this,"importCsvFile").call(this,n,e)})}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)(d(y),d(Je),d(Ne))};static \u0275cmp=_({type:r,selectors:[["app-department-bulk-import-dialog"]],features:[Se],decls:14,vars:8,consts:[["bottomAnchor",""],[3,"keydown.enter","formGroup"],[3,"importCsv","importExcel","downloadCsv","downloadExcel","submit","cancel","goToLine","goTop","goBottom","prevError","nextError","clearAll","exportCsv","exportExcel","title","rowCount","submitting","formInvalid","loading","progress"],[1,"departments-body"],["bulk-options",""],["formControlName","dryRun"],["formControlName","updateExisting"],["formArrayName","rows",1,"rows"],["class","row-card",3,"formGroupName",4,"ngFor","ngForOf"],["mat-stroked-button","",3,"click"],[1,"row-card",3,"formGroupName"],[1,"row-header"],["mat-icon-button","","color","warn",3,"click"],[1,"grid-3"],["matInput","","placeholder","Name","formControlName","name"],["matInput","","placeholder","Rollcall Start","formControlName","rollcallStartTime"],["matInput","","type","number","placeholder","Grace Period","formControlName","gracePeriodMinutes"],["matInput","","placeholder","Description","formControlName","description"],["matInput","","placeholder","Branch Codes","formControlName","branchCodes"],["matInput","","placeholder","Head Usernames","formControlName","headUsernames"],["matInput","","placeholder","Member Usernames","formControlName","memberUsernames"],["class","row-error",4,"ngIf"],[1,"row-error"]],template:function(e,l){if(e&1){let m=K();a(0,"form",1),b("keydown.enter",function(T){return u(m),f(T.stopPropagation())}),a(1,"app-bulk-import-shell",2),b("importCsv",function(T){return u(m),f(l.importCsv(T))})("importExcel",function(T){return u(m),f(l.importExcel(T))})("downloadCsv",function(){return u(m),f(l.downloadCsvTemplate())})("downloadExcel",function(){return u(m),f(l.downloadExcelTemplate())})("submit",function(){return u(m),f(l.submit())})("cancel",function(){return u(m),f(l.close())})("goToLine",function(T){return u(m),f(l.goToLine(T))})("goTop",function(){return u(m),f(l.scrollToTop())})("goBottom",function(){return u(m),f(l.scrollToBottom())})("prevError",function(){return u(m),f(l.goToPreviousError())})("nextError",function(){return u(m),f(l.goToNextError())})("clearAll",function(){return u(m),f(l.clearRows())})("exportCsv",function(){return u(m),f(l.exportCsvCurrentRows())})("exportExcel",function(){return u(m),f(l.exportExcelCurrentRows())}),a(2,"div",3)(3,"div",4)(4,"mat-checkbox",5),o(5," Dry run (validate only) "),i(),a(6,"mat-checkbox",6),o(7," Update existing departments (by name) "),i()(),a(8,"div",7),g(9,at,24,3,"div",8),i(),a(10,"button",9),b("click",function(){return u(m),f(l.addRow())}),o(11," + Add Department "),i(),c(12,"div",null,0),i()()()}e&2&&(p("formGroup",l.form),s(),p("title",l.config.title)("rowCount",l.rowCount)("submitting",l.submitting)("formInvalid",l.form.invalid)("loading",l.submitting||l.loading)("progress",l.progress),s(8),p("ngForOf",l.rows.controls))},dependencies:[C,Ee,X,U,P,O,V,R,F,A,L,we,ke,ze,G,j,H,W,$e,qe,D,I,ne,re,ie],styles:[".departments-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.rows[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.row-card[_ngcontent-%COMP%]{border:1px solid var(--border);border-radius:10px;padding:20px;background:var(--surface);display:flex;flex-direction:column;gap:16px}.row-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:600;border-bottom:1px dashed var(--border);padding-bottom:6px}.grid-3[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}.mat-form-field[_ngcontent-%COMP%]{width:100%}.row-error[_ngcontent-%COMP%]{color:#c62828;font-size:.8rem}.highlight-line[_ngcontent-%COMP%]{outline:2px solid #1976d2;outline-offset:4px;transition:outline .3s ease}"]})};var ot=r=>[r],mt=r=>[r,"edit"];function lt(r,t){r&1&&(a(0,"th",16),o(1,"Name"),i())}function st(r,t){if(r&1&&(a(0,"td",17),o(1),i()),r&2){let n=t.$implicit;s(),Q(n.name)}}function pt(r,t){r&1&&(a(0,"th",16),o(1,"Branches"),i())}function dt(r,t){if(r&1&&(a(0,"td",17),o(1),i()),r&2){let n=t.$implicit,e=S();s(),v(" ",e.branchNames(n)," ")}}function ct(r,t){r&1&&(a(0,"th",16),o(1,"Rollcall"),i())}function ut(r,t){if(r&1&&(a(0,"td",17),o(1),i()),r&2){let n,e=t.$implicit;s(),Me(" ",e.rollcallStartTime||"\u2014"," / ",(n=e.gracePeriodMinutes)!==null&&n!==void 0?n:"\u2014"," min ")}}function ft(r,t){r&1&&c(0,"th",18)}function ht(r,t){if(r&1){let n=K();a(0,"td",19)(1,"button",20)(2,"mat-icon"),o(3,"visibility"),i()(),a(4,"button",21)(5,"mat-icon"),o(6,"edit"),i()(),a(7,"button",22),b("click",function(){let l=u(n).$implicit,m=S();return f(m.delete(l))}),a(8,"mat-icon"),o(9,"delete"),i()()()}if(r&2){let n=t.$implicit;s(),p("routerLink",z(2,ot,n.id)),s(3),p("routerLink",z(4,mt,n.id))}}function bt(r,t){r&1&&c(0,"tr",23)}function gt(r,t){r&1&&c(0,"tr",24)}var ge=class r{constructor(t,n){this.service=t;this.dialog=n}displayedColumns=["name","branches","rollcall","actions"];departments=[];ngOnInit(){this.load()}load(){this.service.getAll(!1).subscribe(t=>this.departments=t)}delete(t){if(!t.id)return;this.dialog.open(Qe,{data:{title:"Delete Department",message:`Delete ${t.name}?`}}).afterClosed().subscribe(e=>{e&&this.service.delete(t.id,!0).subscribe(()=>this.load())})}branchNames(t){return!t.branches||t.branches.length===0?"\u2014":t.branches.map(n=>n.name).join(", ")}openBulkImport(){this.dialog.open(ce,{width:"1100px",maxWidth:"95vw",maxHeight:"90vh",autoFocus:!1}).afterClosed().subscribe(t=>{t===!0&&this.load()})}static \u0275fac=function(n){return new(n||r)(d(y),d(Oe))};static \u0275cmp=_({type:r,selectors:[["app-department-list"]],decls:25,vars:3,consts:[[1,"page-header","flex","items-center","mb-6"],[1,"text-xl","font-semibold"],[1,"flex","items-center","gap-2","ml-auto"],["mat-stroked-button","",3,"click"],["mat-flat-button","","routerLink","create"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","branches"],["matColumnDef","rollcall"],["matColumnDef","actions"],["mat-header-cell","","class","actions-col",4,"matHeaderCellDef"],["mat-cell","","class","actions-col",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"actions-col"],["mat-cell","",1,"actions-col"],["mat-icon-button","","matTooltip","View",3,"routerLink"],["mat-icon-button","","matTooltip","Edit",3,"routerLink"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,e){n&1&&(a(0,"div",0)(1,"h2",1),o(2,"Departments"),i(),a(3,"div",2)(4,"button",3),b("click",function(){return e.openBulkImport()}),a(5,"mat-icon"),o(6,"cloud_upload"),i(),o(7," Bulk Import "),i(),a(8,"button",4),o(9," Create Department "),i()()(),a(10,"table",5),q(11,6),g(12,lt,2,0,"th",7)(13,st,2,1,"td",8),$(),q(14,9),g(15,pt,2,0,"th",7)(16,dt,2,1,"td",8),$(),q(17,10),g(18,ct,2,0,"th",7)(19,ut,2,2,"td",8),$(),q(20,11),g(21,ft,1,0,"th",12)(22,ht,10,6,"td",13),$(),g(23,bt,1,0,"tr",14)(24,gt,1,0,"tr",15),i()),n&2&&(s(10),p("dataSource",e.departments),s(13),p("matHeaderRowDef",e.displayedColumns),s(),p("matRowDefColumns",e.displayedColumns))},dependencies:[C,k,w,He,Re,Pe,Ue,Ve,Fe,je,Ae,Le,Ge,We,re,ie,D,I,ne,Be,Te],styles:[".actions-col[_ngcontent-%COMP%]{width:120px;text-align:right;white-space:nowrap}.actions-col[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:4px}"]})};var _e=class r{constructor(t,n,e,l,m){this.fb=t;this.deptService=n;this.branchService=e;this.userService=l;this.router=m}fg;users=[];branches=[];headIds=[];memberIds=[];branchIds=[];filteredUsers$;filteredBranches$;ngOnInit(){this.fg=this.fb.group({name:["",ee.required],description:[""],rollcallStartTime:["09:00"],gracePeriodMinutes:[15]}),this.userService.list(0,500).subscribe(t=>{this.users=t.data,this.filteredUsers$=this.userService.list(0,500).pipe(J(n=>n.data))}),this.branchService.getAll(!1).subscribe(t=>{this.branches=t,this.filteredBranches$=this.branchService.getAll(!1)})}userDisplay=t=>t.username;userId=t=>t.id;branchDisplay=t=>t.name;branchId=t=>t.id;validateNoOverlap(){return this.headIds.filter(n=>this.memberIds.includes(n)).length?(alert("A user cannot be both head and member."),!1):!0}save(){this.fg.invalid||this.validateNoOverlap()&&this.deptService.create(N(B({},this.fg.value),{headIds:this.headIds,memberIds:this.memberIds,branchIds:this.branchIds})).subscribe(()=>this.router.navigate(["/departments"]))}static \u0275fac=function(n){return new(n||r)(d(te),d(y),d(ae),d(me),d(Z))};static \u0275cmp=_({type:r,selectors:[["app-department-create"]],decls:36,vars:15,consts:[[1,"text-xl","font-semibold","mb-4"],[1,"grid","grid-cols-2","gap-4","bg-[var(--surface)]","p-6","rounded",3,"formGroup"],[1,"col-span-2"],["matInput","","formControlName","name"],["matInput","","formControlName","description"],["matInput","","type","time","formControlName","rollcallStartTime"],["matInput","","type","number","formControlName","gracePeriodMinutes"],[1,"mt-4","col-span-2"],["label","Heads",3,"selectedIdsChange","items","excludeIds","selectedIds","display","id"],["label","Members",3,"selectedIdsChange","items","excludeIds","selectedIds","display","id"],["label","Branches",3,"selectedIdsChange","items","display","id","selectedIds"],[1,"mt-6","flex","gap-2"],["mat-flat-button","",3,"click"],["mat-stroked-button","","routerLink","/departments"]],template:function(n,e){n&1&&(a(0,"h2",0),o(1,"Create Department"),i(),a(2,"form",1)(3,"mat-form-field",2)(4,"mat-label"),o(5,"Name"),i(),c(6,"input",3),i(),a(7,"mat-form-field",2)(8,"mat-label"),o(9,"Description"),i(),c(10,"input",4),i(),a(11,"mat-form-field")(12,"mat-label"),o(13,"Rollcall Start"),i(),c(14,"input",5),i(),a(15,"mat-form-field")(16,"mat-label"),o(17,"Grace Period (min)"),i(),c(18,"input",6),i(),a(19,"mat-expansion-panel",7)(20,"mat-expansion-panel-header"),o(21,"Assign Heads"),i(),a(22,"app-searchable-assign",8),E("selectedIdsChange",function(m){return x(e.headIds,m)||(e.headIds=m),m}),i()(),a(23,"mat-expansion-panel",7)(24,"mat-expansion-panel-header"),o(25,"Assign Members"),i(),a(26,"app-searchable-assign",9),E("selectedIdsChange",function(m){return x(e.memberIds,m)||(e.memberIds=m),m}),i()(),a(27,"mat-expansion-panel",7)(28,"mat-expansion-panel-header"),o(29,"Assign Branches"),i(),a(30,"app-searchable-assign",10),E("selectedIdsChange",function(m){return x(e.branchIds,m)||(e.branchIds=m),m}),i()()(),a(31,"div",11)(32,"button",12),b("click",function(){return e.save()}),o(33,"Save"),i(),a(34,"button",13),o(35,"Cancel"),i()()),n&2&&(s(2),p("formGroup",e.fg),s(20),p("items",e.users)("excludeIds",e.memberIds),M("selectedIds",e.headIds),p("display",e.userDisplay)("id",e.userId),s(4),p("items",e.users)("excludeIds",e.headIds),M("selectedIds",e.memberIds),p("display",e.userDisplay)("id",e.userId),s(4),p("items",e.branches)("display",e.branchDisplay)("id",e.branchId),M("selectedIds",e.branchIds))},dependencies:[C,U,P,O,V,R,F,A,L,k,w,D,I,G,j,oe,H,W,pe,le,se,de],styles:["form[_ngcontent-%COMP%]{background:var(--surface);padding:1.5rem;border-radius:8px;max-width:900px}mat-chip[_ngcontent-%COMP%]{margin:4px}"]})};var It=r=>["/departments",r],ve=class r{constructor(t,n,e,l,m,h){this.fb=t;this.route=n;this.router=e;this.deptService=l;this.branchService=m;this.userService=h}id;fg;users=[];branches=[];headIds=[];memberIds=[];branchIds=[];filteredUsers$;filteredBranches$;ngOnInit(){this.fg=this.fb.group({name:["",ee.required],description:[""],rollcallStartTime:[""],gracePeriodMinutes:[0]}),this.id=this.route.snapshot.paramMap.get("id"),this.userService.list(0,500).subscribe(t=>{this.users=t.data,this.filteredUsers$=this.userService.list(0,500).pipe(J(n=>n.data))}),this.branchService.getAll(!1).subscribe(t=>{this.branches=t,this.filteredBranches$=this.branchService.getAll(!1)}),this.deptService.get(this.id).subscribe(t=>this.loadDepartment(t))}loadDepartment(t){this.fg.patchValue(t),this.headIds=t.heads?.map(n=>n.id)??[],this.memberIds=t.members?.map(n=>n.id)??[],this.branchIds=t.branches?.map(n=>n.id)??[]}userDisplay=t=>t.username;userId=t=>t.id;branchDisplay=t=>t.name;branchId=t=>t.id;validateNoOverlap(){return this.headIds.filter(n=>this.memberIds.includes(n)).length?(alert("A user cannot be both head and member."),!1):!0}save(){this.fg.invalid||this.validateNoOverlap()&&this.deptService.update(this.id,N(B({},this.fg.value),{headIds:this.headIds,memberIds:this.memberIds,branchIds:this.branchIds})).subscribe(()=>this.router.navigate(["/departments",this.id]))}static \u0275fac=function(n){return new(n||r)(d(te),d(Y),d(Z),d(y),d(ae),d(me))};static \u0275cmp=_({type:r,selectors:[["app-department-edit"]],decls:36,vars:18,consts:[[1,"text-xl","font-semibold","mb-4"],[1,"grid","grid-cols-2","gap-4","bg-[var(--surface)]","p-6","rounded",3,"formGroup"],[1,"col-span-2"],["matInput","","formControlName","name"],["matInput","","formControlName","description"],["matInput","","type","time","formControlName","rollcallStartTime"],["matInput","","type","number","formControlName","gracePeriodMinutes"],[1,"mt-4","col-span-2"],["label","Heads",3,"selectedIdsChange","items","excludeIds","selectedIds","display","id"],["label","Members",3,"selectedIdsChange","items","excludeIds","selectedIds","display","id"],["label","Branches",3,"selectedIdsChange","items","display","id","selectedIds"],[1,"mt-6","flex","gap-2"],["mat-flat-button","",3,"click"],["mat-stroked-button","",3,"routerLink"]],template:function(n,e){n&1&&(a(0,"h2",0),o(1,"Edit Department"),i(),a(2,"form",1)(3,"mat-form-field",2)(4,"mat-label"),o(5,"Name"),i(),c(6,"input",3),i(),a(7,"mat-form-field",2)(8,"mat-label"),o(9,"Description"),i(),c(10,"input",4),i(),a(11,"mat-form-field")(12,"mat-label"),o(13,"Rollcall Start"),i(),c(14,"input",5),i(),a(15,"mat-form-field")(16,"mat-label"),o(17,"Grace Period"),i(),c(18,"input",6),i(),a(19,"mat-expansion-panel",7)(20,"mat-expansion-panel-header"),o(21,"Assign Heads"),i(),a(22,"app-searchable-assign",8),E("selectedIdsChange",function(m){return x(e.headIds,m)||(e.headIds=m),m}),i()(),a(23,"mat-expansion-panel",7)(24,"mat-expansion-panel-header"),o(25,"Assign Members"),i(),a(26,"app-searchable-assign",9),E("selectedIdsChange",function(m){return x(e.memberIds,m)||(e.memberIds=m),m}),i()(),a(27,"mat-expansion-panel",7)(28,"mat-expansion-panel-header"),o(29,"Assign Branches"),i(),a(30,"app-searchable-assign",10),E("selectedIdsChange",function(m){return x(e.branchIds,m)||(e.branchIds=m),m}),i()()(),a(31,"div",11)(32,"button",12),b("click",function(){return e.save()}),o(33,"Save"),i(),a(34,"button",13),o(35,"Cancel"),i()()),n&2&&(s(2),p("formGroup",e.fg),s(20),p("items",e.users)("excludeIds",e.memberIds),M("selectedIds",e.headIds),p("display",e.userDisplay)("id",e.userId),s(4),p("items",e.users)("excludeIds",e.headIds),M("selectedIds",e.memberIds),p("display",e.userDisplay)("id",e.userId),s(4),p("items",e.branches)("display",e.branchDisplay)("id",e.branchId),M("selectedIds",e.branchIds),s(4),p("routerLink",z(16,It,e.id)))},dependencies:[C,U,P,O,V,R,F,A,L,k,w,D,I,G,j,oe,H,W,pe,le,se,de],styles:["form[_ngcontent-%COMP%]{background:var(--surface);padding:1.5rem;border-radius:8px;max-width:900px}"]})};var Dt=()=>["edit"];function yt(r,t){if(r&1&&(a(0,"div")(1,"div",1)(2,"h2",2),o(3),i(),a(4,"button",3),o(5,"Edit"),i()(),a(6,"div",4)(7,"div")(8,"strong"),o(9,"Description:"),i(),o(10),i(),a(11,"div")(12,"strong"),o(13,"Rollcall:"),i(),o(14),i(),a(15,"div")(16,"strong"),o(17,"Grace Period:"),i(),o(18),i(),a(19,"div")(20,"strong"),o(21,"Branches:"),i(),o(22),i()()()),r&2){let n,e=S();s(3),Q(e.department.name),s(),p("routerLink",xe(6,Dt)),s(6),v(" ",e.department.description||"\u2014",""),s(4),v(" ",e.department.rollcallStartTime||"\u2014",""),s(4),v(" ",(n=e.department.gracePeriodMinutes)!==null&&n!==void 0?n:"\u2014"," min"),s(4),v(" ",e.branchNames,"")}}var Ce=class r{constructor(t,n){this.route=t;this.service=n}department;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");this.service.get(t).subscribe(n=>this.department=n)}get branchNames(){return!this.department?.branches||this.department.branches.length===0?"\u2014":this.department.branches.map(t=>t.name).join(", ")}static \u0275fac=function(n){return new(n||r)(d(Y),d(y))};static \u0275cmp=_({type:r,selectors:[["app-department-details"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"flex","justify-between","mb-4"],[1,"text-xl","font-semibold"],["mat-stroked-button","",3,"routerLink"],[1,"grid","grid-cols-2","gap-4","text-sm","bg-[var(--surface)]","p-4","rounded"]],template:function(n,e){n&1&&g(0,yt,23,7,"div",0),n&2&&p("ngIf",e.department)},dependencies:[C,X,k,w,D,I],styles:["[_nghost-%COMP%]{display:block}"]})};var Vi=[{path:"",component:ge},{path:"create",component:_e},{path:":id",component:Ce},{path:":id/edit",component:ve}];export{Vi as DEPARTMENT_ROUTES};
