import{a as u}from"./chunk-7GLSX2AB.js";import{c as b}from"./chunk-727AWRP5.js";import{a as m}from"./chunk-NKX2CJ22.js";import{S as l,Z as d,ca as o,m as n}from"./chunk-IL4QWM46.js";var p=class i{constructor(t,e){this.dialog=t;this.snackbar=e}execute(t,e,a){t.subscribe({next:()=>{this.snackbar.open(e,"Close",{duration:2500}),a()},error:r=>{let s=r?.error?.message||r?.message||"Operation failed";this.snackbar.open(s,"Close",{duration:4e3})}})}openReasonDialog(t,e,a){return!a||a.length===0?n({confirmed:!0,reason:null}):this.dialog.open(u,{width:"420px",data:{title:t,message:e,confirmText:"Confirm",reasons:a,allowCustomReason:!0}}).afterClosed().pipe(l(s=>s?.confirmed?n({confirmed:!0,reason:s.reason??null}):n({confirmed:!1,reason:null})))}toggleSingle(t,e){if(!!!t.deleted){this.openReasonDialog(`Disable ${e.entityName}?`,`Provide a reason for disabling ${e.displayName(t)} (optional).`,e.disableReasons).subscribe(r=>{r.confirmed&&this.execute(e.disable(t.id,r.reason),`${e.entityName} disabled`,e.reload)});return}this.openReasonDialog(`Restore ${e.entityName}?`,`Provide a reason for restoring ${e.displayName(t)} (optional).`,e.restoreReasons).subscribe(r=>{r.confirmed&&this.execute(e.restore(t.id,r.reason),`${e.entityName} restored`,e.reload)})}bulkDisable(t,e){if(!e.disableBulk)return;let a=t.map(r=>r.id);this.openReasonDialog(`Disable ${e.entityName}s?`,"Provide a reason (optional).",e.disableReasons).subscribe(r=>{r.confirmed&&this.execute(e.disableBulk(a,r.reason),`${e.entityName}s disabled`,e.reload)})}bulkRestore(t,e){if(!e.restoreBulk)return;let a=t.map(r=>r.id);this.openReasonDialog(`Restore ${e.entityName}s?`,"Provide a reason (optional).",e.restoreReasons).subscribe(r=>{r.confirmed&&this.execute(e.restoreBulk(a,r.reason),`${e.entityName}s restored`,e.reload)})}bulkHardDelete(t,e){if(!e.hardDeleteBulk)return;let a=t.map(r=>r.id);this.openReasonDialog(`Delete ${e.entityName}s Permanently?`,`You are about to permanently delete ${t.length} ${e.entityName.toLowerCase()}(s).`,e.deleteReasons).subscribe(r=>{r.confirmed&&this.execute(e.hardDeleteBulk(a,r.reason),`${e.entityName}s permanently deleted`,e.reload)})}static \u0275fac=function(e){return new(e||i)(o(b),o(m))};static \u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"})};export{p as a};
