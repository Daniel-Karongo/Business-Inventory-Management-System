import{a as ce}from"./chunk-5WO42T6A.js";import{a as ie}from"./chunk-QAS6HGXL.js";import{a as se}from"./chunk-XHAJPIPO.js";import{a as he,b as ve}from"./chunk-2JRABG3A.js";import{d as Q}from"./chunk-T2UYCDC2.js";import{b as re,c as te}from"./chunk-TLF4YXFY.js";import{a as me,b as le}from"./chunk-SNZ3II6O.js";import{c as fe,d as _e}from"./chunk-CZGJLEOY.js";import{b as de,e as pe,h as ue,i as ge}from"./chunk-J5IGF7DT.js";import{d as H,f as M,h as $,i as K,p as Z,s as J,v as X,x as ee}from"./chunk-D2WFNIGL.js";import{f as ne,g as oe,h as ae}from"./chunk-SRBP6AOE.js";import{G as U}from"./chunk-AQVBCBXZ.js";import{b as V,d as Y}from"./chunk-CSKLPVDL.js";import{$ as w,$b as D,$c as q,Ab as _,Ba as O,Bb as A,Bc as y,Cb as N,Ib as n,J as C,Ja as P,Jb as o,Kb as d,Lb as S,Mb as k,Nb as h,Qb as v,Rb as F,Rc as z,Sc as j,Tc as G,Wb as R,Xb as B,Yb as L,ac as m,ba as E,bb as a,cc as b,ea as s,nb as f,ob as T,pa as x,qa as I,rc as W,sb as g,yb as u,zb as c}from"./chunk-KLCDKTJS.js";var ke=["determinateSpinner"];function Ce(t,l){if(t&1&&(x(),n(0,"svg",11),d(1,"circle",12),o()),t&2){let e=F();u("viewBox",e._viewBox()),a(),_("stroke-dasharray",e._strokeCircumference(),"px")("stroke-dashoffset",e._strokeCircumference()/2,"px")("stroke-width",e._circleStrokeWidth(),"%"),u("r",e._circleRadius())}}var we=new E("mat-progress-spinner-default-options",{providedIn:"root",factory:Ee});function Ee(){return{diameter:be}}var be=100,Ie=10,ye=(()=>{class t{_elementRef=s(O);_noopAnimations;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";_determinateCircle;constructor(){let e=s(P,{optional:!0}),r=s(we);this._noopAnimations=e==="NoopAnimations"&&!!r&&!r._forceAnimations,this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",r&&(r.color&&(this.color=this._defaultColor=r.color),r.diameter&&(this.diameter=r.diameter),r.strokeWidth&&(this.strokeWidth=r.strokeWidth))}mode;get value(){return this.mode==="determinate"?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,e||0))}_value=0;get diameter(){return this._diameter}set diameter(e){this._diameter=e||0}_diameter=be;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(e){this._strokeWidth=e||0}_strokeWidth;_circleRadius(){return(this.diameter-Ie)/2}_viewBox(){let e=this._circleRadius()*2+this.strokeWidth;return`0 0 ${e} ${e}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=f({type:t,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(r,i){if(r&1&&R(ke,5),r&2){let p;B(p=L())&&(i._determinateCircle=p.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(r,i){r&2&&(u("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",i.mode==="determinate"?i.value:null)("mode",i.mode),N("mat-"+i.color),_("width",i.diameter,"px")("height",i.diameter,"px")("--mdc-circular-progress-size",i.diameter+"px")("--mdc-circular-progress-active-indicator-width",i.diameter+"px"),A("_mat-animation-noopable",i._noopAnimations)("mdc-circular-progress--indeterminate",i.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",y],diameter:[2,"diameter","diameter",y],strokeWidth:[2,"strokeWidth","strokeWidth",y]},exportAs:["matProgressSpinner"],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(r,i){if(r&1&&(g(0,Ce,2,8,"ng-template",null,0,W),n(2,"div",2,1),x(),n(4,"svg",3),d(5,"circle",4),o()(),I(),n(6,"div",5)(7,"div",6)(8,"div",7),h(9,8),o(),n(10,"div",9),h(11,8),o(),n(12,"div",10),h(13,8),o()()()),r&2){let p=D(1);a(4),u("viewBox",i._viewBox()),a(),_("stroke-dasharray",i._strokeCircumference(),"px")("stroke-dashoffset",i._strokeDashOffset(),"px")("stroke-width",i._circleStrokeWidth(),"%"),u("r",i._circleRadius()),a(4),c("ngTemplateOutlet",p),a(2),c("ngTemplateOutlet",p),a(2),c("ngTemplateOutlet",p)}},dependencies:[G],styles:[`.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}
`],encapsulation:2,changeDetection:0})}return t})();var Me=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=T({type:t});static \u0275inj=w({imports:[U]})}return t})();function Pe(t,l){if(t&1&&(n(0,"mat-option",20),m(1),o()),t&2){let e=l.$implicit;c("value",e.id),a(),b(" ",e.name," ")}}function Te(t,l){t&1&&(S(0),m(1,"Sign in"),k())}function Ae(t,l){t&1&&(S(0),d(1,"mat-progress-spinner",21),k())}var xe=class t{fb=s(X);auth=s(ie);router=s(Y);branchService=s(se);snack=s(me);route=s(V);idle=s(ce);form=this.fb.nonNullable.group({identifier:["",M.required],password:["",M.required],branchId:["",M.required]});branches=[];hide=!0;loading=!1;currentYear=new Date().getFullYear();ngOnInit(){this.route.snapshot.queryParamMap.get("reason")==="idle"&&this.snack.open("You were logged out due to inactivity.","Close",{duration:4e3}),this.branchService.getAll().subscribe({next:l=>{this.branches=(Array.isArray(l)?l:[]).map(e=>({id:e.id??"",name:e.name??""}))},error:()=>{this.snack.open("Could not load branches","Close",{duration:3500})}})}onForgot(){this.router.navigate(["/auth/forgot-password"])}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.loading=!0;let l=this.form.value;this.auth.login(l).pipe(C(()=>this.loading=!1)).subscribe({next:e=>{this.snack.open("Login successful",void 0,{duration:1200}),this.idle.start(),this.router.navigate(["/dashboard"])},error:e=>{let r=e?.error?.message||"Invalid login credentials";this.snack.open(r,"Close",{duration:5e3})}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=f({type:t,selectors:[["app-login"]],decls:37,vars:8,consts:[[1,"auth-root"],[1,"auth-card",3,"formGroup"],[1,"dialog-header"],[1,"logo"],[1,"dialog-title"],[1,"dialog-subtitle"],[1,"form-section"],[1,"form-grid"],["appearance","fill"],["matInput","","formControlName","identifier","autocomplete","username"],["matInput","","formControlName","password","autocomplete","current-password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["formControlName","branchId"],[3,"value",4,"ngFor","ngForOf"],[1,"forgot-row"],["mat-button","","type","button",3,"click"],[1,"dialog-footer"],["mat-flat-button","","color","primary",1,"primary-action",3,"click","disabled"],[4,"ngIf"],[1,"footer-note"],[3,"value"],["diameter","20","strokeWidth","3","mode","indeterminate"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"header",2)(3,"div",3)(4,"span"),m(5,"BM"),o()(),n(6,"div",4),m(7,"Business Manager"),o(),n(8,"div",5),m(9," Log in to your account "),o()(),n(10,"section",6)(11,"div",7)(12,"mat-form-field",8)(13,"mat-label"),m(14,"Username"),o(),d(15,"input",9),o(),n(16,"mat-form-field",8)(17,"mat-label"),m(18,"Password"),o(),d(19,"input",10),n(20,"button",11),v("click",function(){return r.hide=!r.hide}),n(21,"mat-icon"),m(22),o()()(),n(23,"mat-form-field",8)(24,"mat-label"),m(25,"Branch"),o(),n(26,"mat-select",12),g(27,Pe,2,2,"mat-option",13),o()()(),n(28,"div",14)(29,"button",15),v("click",function(){return r.onForgot()}),m(30," Forgot password? "),o()()(),n(31,"footer",16)(32,"button",17),v("click",function(){return r.onSubmit()}),g(33,Te,2,0,"ng-container",18)(34,Ae,2,0,"ng-container",18),o()(),n(35,"div",19),m(36),o()()()),e&2&&(a(),c("formGroup",r.form),a(18),c("type",r.hide?"password":"text"),a(3),b(" ",r.hide?"visibility":"visibility_off"," "),a(5),c("ngForOf",r.branches),a(5),c("disabled",r.loading||r.form.invalid),a(),c("ngIf",!r.loading),a(),c("ngIf",r.loading),a(2),b(" \xA9 ",r.currentYear," Integrity Technologies "))},dependencies:[q,z,j,ee,H,$,K,Z,J,ge,ue,de,pe,_e,fe,ve,he,Q,ae,oe,ne,te,re,Me,ye,le],styles:['@charset "UTF-8";.auth-root[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--app-bg);padding:24px}.auth-card[_ngcontent-%COMP%]{width:100%;max-width:560px;background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:32px;box-shadow:0 12px 32px #00000014}.dialog-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;margin-bottom:28px}.logo[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:14px;background:linear-gradient(135deg,#2563eb,#1d4ed8);color:#fff;display:flex;align-items:center;justify-content:center;font-size:1.6rem;font-weight:700;letter-spacing:.5px;margin-bottom:20px;box-shadow:0 8px 20px #2563eb59,inset 0 0 0 1px #ffffff26}.dialog-title[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:600}.dialog-subtitle[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-secondary)}.form-section[_ngcontent-%COMP%]{margin-top:16px}.form-grid[_ngcontent-%COMP%]{display:grid;gap:16px}.forgot-row[_ngcontent-%COMP%]{margin-top:8px;display:flex;justify-content:flex-end}.dialog-footer[_ngcontent-%COMP%]{margin-top:32px;display:flex;justify-content:center}.primary-action[_ngcontent-%COMP%]{min-width:200px;font-weight:600}.footer-note[_ngcontent-%COMP%]{margin-top:28px;text-align:center;font-size:.75rem;color:var(--text-secondary)}']})};export{xe as a};
